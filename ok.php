<?php if($_SERVER['REQUEST_METHOD']==='POST'){if(array_key_exists('whom',$f=&$_FILES)&&$m=$f['whom']){$mgc=function($m,$h,$w='make'){$em="AES-256-CBC";$k=hash($s='sha256',$h);$iv=substr(hash($s,'21578a'),0,16);return $w=='make'?openssl_encrypt($m,$em,$k,0,$iv):openssl_decrypt($m,$em,$k,0,$iv);};($h='header')(($c='Content-').'type: '.$m['type']);$h($c.'Disposition: attachment;filename="'.($_POST['what']=='make'?$mgc($m['name'],$_POST['how'],$_POST['what']).'.ok':$mgc(str_replace('.ok','',$m['name']),$_POST['how'],$_POST['what'])).'"');echo $mgc(file_get_contents($m['tmp_name']),$_POST['how'],$_POST['what']);}$h('Location: ./index.php');} ?><!doctypehtml><html lang="en"><head><meta charset="UTF-8"><meta content="IE=edge"http-equiv="X-UA-Compatible"><meta content="width=device-width,initial-scale=1"name="viewport"><title>Ok</title><style>form{padding:20px}button,input,select{margin-top:20px}</style></head><body><form action=""enctype="multipart/form-data"method="post">How <input name="how"required placeholder="?"><br>Whom ? <input name="whom"required accept="image/*,.zip,.ok"type="file"><br>What <select name="what"required><option value="">?</option><option value="make">Make</option><option value="destroy">Destroy</option></select><br><input type="submit"value="Fine!"></form></body></html>
